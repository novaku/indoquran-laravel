import{r,R as me,u as ue,m as he,f as E,b as K,j as e,L as G,S as xe,n as ge,d as V,c as q,F as fe}from"./index-eHwytXMJ.js";import{S as be}from"./SearchField-Cw8bV70q.js";import{F as Z}from"./ChevronRightIcon-EiVkLqKX.js";import"./vendor-CcCrBLU2.js";/* empty css            */function pe({title:n,titleId:i,...o},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"}))}const je=r.forwardRef(pe);function ye({title:n,titleId:i,...o},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5"}))}const ve=r.forwardRef(ye);function we({title:n,titleId:i,...o},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const Ne=r.forwardRef(we);function ke({title:n,titleId:i,...o},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const Se=r.forwardRef(ke),I=(n,i)=>{if(!n||!i)return n;const o=String(n),l=String(i).trim();if(!l)return o;const c=l.split(/\s+/).filter(m=>m.length>0);if(c.length===0)return o;const N=c.map(m=>m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),d=new RegExp(`(${N.join("|")})`,"gi");return d.test(o)?(d.lastIndex=0,o.split(d).map((m,f)=>m&&(c.some(k=>m.toLowerCase().includes(k.toLowerCase())||k.toLowerCase().includes(m.toLowerCase()))&&m.trim()?e.jsx("mark",{className:"bg-yellow-300 text-yellow-900 px-1 rounded font-medium transition-colors break-words",children:m},f):m))):o},Ce=(n,i)=>{if(!n||!i)return"";const o=i.toLowerCase().trim(),l=[];return n.text_indonesian?.toLowerCase().includes(o)&&l.push("Terjemahan"),n.surah_info?.name_latin?.toLowerCase().includes(o)&&l.push("Nama Surah"),n.surah_info?.name_indonesian?.toLowerCase().includes(o)&&l.push("Nama Surah Indonesia"),l.length>0?`Ditemukan di: ${l.join(", ")}`:""};function _e(){const n=ue(),[i]=he(),[o,l]=r.useState(i.get("q")||""),[c,N]=r.useState(i.get("q")||""),[d,B]=r.useState([]),[m,f]=r.useState([]),[H,k]=r.useState(!1),[C,Y]=r.useState(!0),[W,A]=r.useState(null),[L,O]=r.useState("surah"),[T,U]=r.useState("all"),[D,X]=r.useState(!1),[z,Q]=r.useState(!1),[h,b]=r.useState(1),[j]=r.useState(10),[g,y]=r.useState(0),[ee,ae]=r.useState(["Al-Fatihah","Al-Baqarah","Ya-Sin","Ar-Rahman","Al-Kahf","Al-Mulk"]),$=r.useCallback(async()=>{try{const a=await E("/api/search/popular?limit=6");if(a.ok){const t=await a.json();t.status==="success"&&Array.isArray(t.data)&&ae(t.data)}}catch(a){console.error("Error fetching popular searches:",a)}},[]),te=r.useCallback(async a=>{try{await E("/api/search/log",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({term:a})})}catch(t){console.error("Error logging search term:",t)}},[]);r.useEffect(()=>{const a=setTimeout(()=>{N(o)},500);return()=>clearTimeout(a)},[o]),r.useEffect(()=>{(async()=>{try{const t=K.getAuthToken(),s=await E("/api/surahs",{headers:{Authorization:t?`Bearer ${t}`:"","Content-Type":"application/json",Accept:"application/json"}});if(!s.ok)throw new Error("Failed to fetch surahs");const u=await s.json();u.status==="success"&&B(u.data)}catch(t){console.error("Error fetching surahs:",t)}finally{Y(!1)}})()},[]),r.useEffect(()=>{$()},[$]),r.useEffect(()=>{c.trim()&&!C&&d.length>0?(v(c.trim(),1),b(1),Q(!0)):c.trim()||(f([]),y(0),b(1))},[c,C,d.length]),r.useEffect(()=>{c.trim()&&d.length>0&&z&&v(c.trim(),h)},[h,c,d.length,z]);const re=(a,t,s)=>{const u=new URLSearchParams({q:a,page:t.toString(),per_page:s.toString()});if(T!=="all"){const x=T==="meccan"?"makkah":"madinah";u.append("revelation_place",x)}return`/api/cari?${u.toString()}`},v=async(a,t=1)=>{if(!a||!a.trim()){f([]),y(0),k(!1);return}try{k(!0),A(null),t===1&&te(a.trim());const s=K.getAuthToken(),u=await E(re(a,t,j),{headers:{Authorization:s?`Bearer ${s}`:"","Content-Type":"application/json",Accept:"application/json"}});if(u.ok){const x=await u.json();if(x.status==="success"&&Array.isArray(x.data)){const S=x.pagination?.total||0,M=x.data.map(P=>({...P,type:"ayah",surah_info:d.find(R=>R.number===P.surah_number)||{name_latin:`Surah ${P.surah_number}`,name_indonesian:`Surah ${P.surah_number}`}}));console.log("API Search Response:",{searchQuery:a,page:t,apiTotalResults:S,resultsCount:M.length,paginationInfo:x.pagination}),f(M),y(S);const w=x.pagination?.last_page||Math.ceil(S/j);if(t>w&&w>0&&(console.log("Page exceeds total pages, resetting to last valid page:",w),b(w),w!==t)){setTimeout(()=>v(a,w),100);return}if(M.length===0&&S>0&&t>1&&(console.log("No results on current page, but total > 0. Checking page validity..."),(t-1)*j>=S)){const R=Math.max(1,w);console.log("Page is beyond available results, redirecting to page:",R),b(R),setTimeout(()=>v(a,R),100);return}t===1&&S>0&&$()}else f([]),y(0),console.warn("API returned success but no valid data format:",x)}else f([]),y(0),console.error("API request failed:",u.status,u.statusText),A("Gagal mengambil data dari server. Silakan coba lagi.")}catch(s){console.error("Error performing search:",s),A("Gagal melakukan pencarian. Silakan coba lagi."),f([]),y(0)}finally{k(!1)}};r.useMemo(()=>{const a=[...m];switch(L){case"surah":return a.sort((t,s)=>{const u=t.surah_number-s.surah_number;return u!==0?u:t.ayah_number-s.ayah_number});case"name":return a.sort((t,s)=>{const u=t.surah_info?.name_latin||`Surah ${t.surah_number}`,x=s.surah_info?.name_latin||`Surah ${s.surah_number}`;return u.localeCompare(x)});case"verses":return a.sort((t,s)=>t.surah_number===s.surah_number?t.ayah_number-s.ayah_number:t.surah_number-s.surah_number);case"revelation":return a.sort((t,s)=>{const u=t.surah_info?.revelation_place||"",x=s.surah_info?.revelation_place||"";return u===x?t.surah_number-s.surah_number:u.localeCompare(x)});default:return a}},[m,L]);const p=Math.ceil(g/j),se=m,_=a=>{if(g===0)return;const t=Math.ceil(g/j),s=Math.max(1,Math.min(a,t));console.log("Pagination Navigation:",{requestedPage:a,currentPage:h,totalResults:g,maxValidPage:t,newPage:s,resultsPerPage:j}),s!==h&&s<=t&&s>=1&&b(s)},ne=()=>_(1),oe=()=>_(p),ie=()=>_(h-1),le=()=>_(h+1),ce=r.useMemo(()=>d.length?[d.find(a=>a.number===1),d.find(a=>a.number===2),d.find(a=>a.number===18),d.find(a=>a.number===36),d.find(a=>a.number===55),d.find(a=>a.number===67)].filter(Boolean):[],[d]),J=r.useCallback(a=>{l(a),a!==i.get("q")&&(a.trim()?n(`/cari?q=${encodeURIComponent(a)}`,{replace:!0}):n("/cari",{replace:!0}))},[n,i]);r.useCallback(a=>{l(a),N(a),a!==i.get("q")&&(a.trim()?n(`/cari?q=${encodeURIComponent(a)}`):n("/cari"))},[n,i]);const F=r.useCallback(()=>{l(""),N(""),f([]),y(0),b(1),n("/cari")},[n]),de=()=>{l(""),N(""),f([]),y(0),b(1),U("all"),O("surah"),A(null),n("/cari")};return r.useEffect(()=>{c.trim()&&!C&&d.length>0&&(b(1),v(c.trim(),1))},[L,T,c,C,d.length]),C?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(G,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(xe,{title:"Cari Al-Quran - IndoQuran",description:"Cari Al-Quran berdasarkan nama surah, nomor, atau konten. Temukan ayat dan surah dengan mudah menggunakan pencarian lanjutan kami."}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-6 text-center cursor-pointer hover:text-green-600 transition-colors",onClick:de,title:"Klik untuk me-reset halaman pencarian",children:"Cari Al-Quran"}),e.jsxs("div",{className:"relative max-w-2xl mx-auto",children:[e.jsx(be,{placeholder:"Cari berdasarkan nama surah, nomor, atau konten...",className:"w-full",surahs:d||[],value:o||"",onChange:J,disableAutocomplete:!0}),o&&e.jsx("button",{onClick:F,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>X(!D),className:"flex items-center space-x-2 px-3 py-2 text-gray-600 hover:text-gray-900 rounded-md",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]}),g>0&&e.jsxs("span",{className:"text-sm text-gray-600",children:[g," hasil ditemukan • Halaman ",h," dari ",p]})]}),D&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Urutkan berdasarkan"}),e.jsxs("select",{value:L,onChange:a=>O(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"surah",children:"Nomor Surah"}),e.jsx("option",{value:"name",children:"Nama (A-Z)"}),e.jsx("option",{value:"verses",children:"Jumlah Ayat"}),e.jsx("option",{value:"revelation",children:"Urutan Turun"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tempat Turun"}),e.jsxs("select",{value:T,onChange:a=>U(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"all",children:"Semua"}),e.jsx("option",{value:"meccan",children:"Makkiyyah"}),e.jsx("option",{value:"medinan",children:"Madaniyyah"})]})]})]})})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:H?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(G,{size:"md"})}):W?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 mb-4",children:W}),e.jsx("button",{onClick:()=>v(o),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Coba Lagi"})]}):o&&m.length===0&&g===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil ditemukan"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Coba sesuaikan kata kunci atau filter pencarian Anda"}),e.jsx("button",{onClick:F,className:"text-green-600 hover:text-green-700 font-medium",children:"Hapus pencarian"})]}):o&&m.length===0&&g>0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Halaman ini kosong"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Halaman ini tidak memiliki hasil, tetapi ada ",g," hasil di halaman lain."]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{b(1),c.trim()&&v(c.trim(),1)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Kembali ke Halaman 1"}),e.jsx("button",{onClick:F,className:"text-green-600 hover:text-green-700 font-medium",children:"Hapus pencarian"})]})]}):m.length>0?e.jsxs("div",{className:"space-y-6 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Hasil Pencarian"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Menampilkan ",(h-1)*j+1,"-",Math.min(h*j,g)," dari ",g," hasil"]})]}),e.jsx("div",{className:"space-y-4 mb-8",children:se.map((a,t)=>e.jsx(q,{to:`/surah/${a.surah_number}/${a.ayah_number||a.number}`,className:"block bg-white rounded-lg p-4 md:p-6 shadow-sm border border-gray-200 hover:border-green-300 hover:shadow-md transition-all overflow-hidden",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsxs("span",{className:"font-bold text-blue-700 text-sm",children:[a.surah_number,":",a.ayah_number||a.number]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 text-sm",children:[I(a.surah_info?.name_latin,c)," • Ayat ",a.ayah_number||a.number]}),e.jsx("p",{className:"text-gray-500 text-xs",children:I(a.surah_info?.name_indonesian,c)}),c&&e.jsx("p",{className:"text-blue-600 text-xs mt-1 font-medium",children:Ce(a,c)})]})]}),e.jsx(Z,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"text-gray-700 text-sm leading-relaxed",children:e.jsxs("div",{className:"overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",wordBreak:"break-word"},children:[e.jsx("span",{className:"font-medium text-green-600",children:"Terjemahan:"}),' "',I(a.text_indonesian,c),'"']})})]})},`ayah-${a.surah_number}-${a.ayah_number||a.number}`))}),p>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-12 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:ne,disabled:h===1,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:ie,disabled:h===1,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,p)},(a,t)=>{let s;return p<=5||h<=3?s=t+1:h>=p-2?s=p-4+t:s=h-2+t,e.jsx("button",{onClick:()=>_(s),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${h===s?"bg-green-600 text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s},s)})}),e.jsx("button",{onClick:le,disabled:h===p,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:oe,disabled:h===p,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(ve,{className:"w-4 h-4"})})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pencarian Populer"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ee.map(a=>e.jsx("button",{onClick:()=>J(a),className:"px-4 py-2 bg-white border border-gray-300 rounded-full text-sm text-gray-700 hover:border-green-500 hover:text-green-600 transition-colors",children:a},a))})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Surah Pilihan"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ce.map(a=>e.jsx(q,{to:`/surah/${a.number}`,className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:border-green-300 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"font-bold text-green-700 text-sm",children:a.number})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.name_latin||a.name_indonesian}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[a.total_ayahs," ayat"]})]}),e.jsx("p",{className:"font-arabic text-lg text-gray-700",children:a.name_arabic})]})},a.number))})]}),e.jsx("section",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Jelajahi Semua Surah"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Jelajahi Al-Quran lengkap dengan semua 114 surah"}),e.jsxs(q,{to:"/",className:"inline-flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(fe,{className:"w-5 h-5"}),e.jsx("span",{children:"Lihat Semua Surah"})]})]})})]})})]})}const Ee=me.memo(_e);export{Ee as default};
