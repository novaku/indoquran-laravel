import{r as t,R as le,u as ce,l as de,b as z,f as J,j as e,L as K,S as me,m as ue,d as G,c as F,F as he}from"./index-CyKsVLCQ.js";import{S as xe}from"./SearchField-Bhop1RLt.js";import{F as V}from"./ChevronRightIcon-DXmkwMF5.js";import"./vendor-CcCrBLU2.js";/* empty css            */function ge({title:n,titleId:i,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?t.createElement("title",{id:i},n):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"}))}const fe=t.forwardRef(ge);function be({title:n,titleId:i,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?t.createElement("title",{id:i},n):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5"}))}const pe=t.forwardRef(be);function je({title:n,titleId:i,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?t.createElement("title",{id:i},n):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const ye=t.forwardRef(je);function ve({title:n,titleId:i,...o},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":i},o),n?t.createElement("title",{id:i},n):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const we=t.forwardRef(ve),M=(n,i)=>{if(!n||!i)return n;const o=String(n),l=String(i).trim();if(!l)return o;const c=l.split(/\s+/).filter(m=>m.length>0);if(c.length===0)return o;const N=c.map(m=>m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),d=new RegExp(`(${N.join("|")})`,"gi");return d.test(o)?(d.lastIndex=0,o.split(d).map((m,f)=>m&&(c.some(k=>m.toLowerCase().includes(k.toLowerCase())||k.toLowerCase().includes(m.toLowerCase()))&&m.trim()?e.jsx("mark",{className:"bg-yellow-300 text-yellow-900 px-1 rounded font-medium transition-colors break-words",children:m},f):m))):o},Ne=(n,i)=>{if(!n||!i)return"";const o=i.toLowerCase().trim(),l=[];return n.text_indonesian?.toLowerCase().includes(o)&&l.push("Terjemahan"),n.surah_info?.name_latin?.toLowerCase().includes(o)&&l.push("Nama Surah"),n.surah_info?.name_indonesian?.toLowerCase().includes(o)&&l.push("Nama Surah Indonesia"),l.length>0?`Ditemukan di: ${l.join(", ")}`:""};function ke(){const n=ce(),[i]=de(),[o,l]=t.useState(i.get("q")||""),[c,N]=t.useState(i.get("q")||""),[d,q]=t.useState([]),[m,f]=t.useState([]),[I,k]=t.useState(!1),[S,Z]=t.useState(!0),[B,L]=t.useState(null),[A,H]=t.useState("surah"),[$,W]=t.useState("all"),[U,Y]=t.useState(!1),[O,X]=t.useState(!1),[h,b]=t.useState(1),[j]=t.useState(10),[g,y]=t.useState(0);t.useEffect(()=>{const a=setTimeout(()=>{N(o)},500);return()=>clearTimeout(a)},[o]),t.useEffect(()=>{(async()=>{try{const s=z.getAuthToken(),r=await J("/api/surahs",{headers:{Authorization:s?`Bearer ${s}`:"","Content-Type":"application/json",Accept:"application/json"}});if(!r.ok)throw new Error("Failed to fetch surahs");const u=await r.json();u.status==="success"&&q(u.data)}catch(s){console.error("Error fetching surahs:",s)}finally{Z(!1)}})()},[]),t.useEffect(()=>{c.trim()&&!S&&d.length>0?(v(c.trim(),1),b(1),X(!0)):c.trim()||(f([]),y(0),b(1))},[c,S,d.length]),t.useEffect(()=>{c.trim()&&d.length>0&&O&&v(c.trim(),h)},[h,c,d.length,O]);const Q=(a,s,r)=>{const u=new URLSearchParams({q:a,page:s.toString(),per_page:r.toString()});if($!=="all"){const x=$==="meccan"?"makkah":"madinah";u.append("revelation_place",x)}return`/api/cari?${u.toString()}`},v=async(a,s=1)=>{if(!a||!a.trim()){f([]),y(0),k(!1);return}try{k(!0),L(null);const r=z.getAuthToken(),u=await J(Q(a,s,j),{headers:{Authorization:r?`Bearer ${r}`:"","Content-Type":"application/json",Accept:"application/json"}});if(u.ok){const x=await u.json();if(x.status==="success"&&Array.isArray(x.data)){const C=x.pagination?.total||0,E=x.data.map(R=>({...R,type:"ayah",surah_info:d.find(P=>P.number===R.surah_number)||{name_latin:`Surah ${R.surah_number}`,name_indonesian:`Surah ${R.surah_number}`}}));console.log("API Search Response:",{searchQuery:a,page:s,apiTotalResults:C,resultsCount:E.length,paginationInfo:x.pagination}),f(E),y(C);const w=x.pagination?.last_page||Math.ceil(C/j);if(s>w&&w>0&&(console.log("Page exceeds total pages, resetting to last valid page:",w),b(w),w!==s)){setTimeout(()=>v(a,w),100);return}if(E.length===0&&C>0&&s>1&&(console.log("No results on current page, but total > 0. Checking page validity..."),(s-1)*j>=C)){const P=Math.max(1,w);console.log("Page is beyond available results, redirecting to page:",P),b(P),setTimeout(()=>v(a,P),100);return}}else f([]),y(0),console.warn("API returned success but no valid data format:",x)}else f([]),y(0),console.error("API request failed:",u.status,u.statusText),L("Gagal mengambil data dari server. Silakan coba lagi.")}catch(r){console.error("Error performing search:",r),L("Gagal melakukan pencarian. Silakan coba lagi."),f([]),y(0)}finally{k(!1)}};t.useMemo(()=>{const a=[...m];switch(A){case"surah":return a.sort((s,r)=>{const u=s.surah_number-r.surah_number;return u!==0?u:s.ayah_number-r.ayah_number});case"name":return a.sort((s,r)=>{const u=s.surah_info?.name_latin||`Surah ${s.surah_number}`,x=r.surah_info?.name_latin||`Surah ${r.surah_number}`;return u.localeCompare(x)});case"verses":return a.sort((s,r)=>s.surah_number===r.surah_number?s.ayah_number-r.ayah_number:s.surah_number-r.surah_number);case"revelation":return a.sort((s,r)=>{const u=s.surah_info?.revelation_place||"",x=r.surah_info?.revelation_place||"";return u===x?s.surah_number-r.surah_number:u.localeCompare(x)});default:return a}},[m,A]);const p=Math.ceil(g/j),ee=m,_=a=>{if(g===0)return;const s=Math.ceil(g/j),r=Math.max(1,Math.min(a,s));console.log("Pagination Navigation:",{requestedPage:a,currentPage:h,totalResults:g,maxValidPage:s,newPage:r,resultsPerPage:j}),r!==h&&r<=s&&r>=1&&b(r)},ae=()=>_(1),te=()=>_(p),re=()=>_(h-1),se=()=>_(h+1),ne=["Al-Fatihah","Al-Baqarah","Ya-Sin","Ar-Rahman","Al-Kahf","Al-Mulk"],oe=t.useMemo(()=>d.length?[d.find(a=>a.number===1),d.find(a=>a.number===2),d.find(a=>a.number===18),d.find(a=>a.number===36),d.find(a=>a.number===55),d.find(a=>a.number===67)].filter(Boolean):[],[d]),D=t.useCallback(a=>{l(a),a!==i.get("q")&&(a.trim()?n(`/cari?q=${encodeURIComponent(a)}`,{replace:!0}):n("/cari",{replace:!0}))},[n,i]);t.useCallback(a=>{l(a),N(a),a!==i.get("q")&&(a.trim()?n(`/cari?q=${encodeURIComponent(a)}`):n("/cari"))},[n,i]);const T=t.useCallback(()=>{l(""),N(""),f([]),y(0),b(1),n("/cari")},[n]),ie=()=>{l(""),N(""),f([]),y(0),b(1),W("all"),H("surah"),L(null),n("/cari")};return t.useEffect(()=>{c.trim()&&!S&&d.length>0&&(b(1),v(c.trim(),1))},[A,$,c,S,d.length]),S?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(K,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(me,{title:"Cari Al-Quran - IndoQuran",description:"Cari Al-Quran berdasarkan nama surah, nomor, atau konten. Temukan ayat dan surah dengan mudah menggunakan pencarian lanjutan kami."}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-6 text-center cursor-pointer hover:text-green-600 transition-colors",onClick:ie,title:"Klik untuk me-reset halaman pencarian",children:"Cari Al-Quran"}),e.jsxs("div",{className:"relative max-w-2xl mx-auto",children:[e.jsx(xe,{placeholder:"Cari berdasarkan nama surah, nomor, atau konten...",className:"w-full",surahs:d||[],value:o||"",onChange:D,disableAutocomplete:!0}),o&&e.jsx("button",{onClick:T,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(ue,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>Y(!U),className:"flex items-center space-x-2 px-3 py-2 text-gray-600 hover:text-gray-900 rounded-md",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]}),g>0&&e.jsxs("span",{className:"text-sm text-gray-600",children:[g," hasil ditemukan • Halaman ",h," dari ",p]})]}),U&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Urutkan berdasarkan"}),e.jsxs("select",{value:A,onChange:a=>H(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"surah",children:"Nomor Surah"}),e.jsx("option",{value:"name",children:"Nama (A-Z)"}),e.jsx("option",{value:"verses",children:"Jumlah Ayat"}),e.jsx("option",{value:"revelation",children:"Urutan Turun"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tempat Turun"}),e.jsxs("select",{value:$,onChange:a=>W(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"all",children:"Semua"}),e.jsx("option",{value:"meccan",children:"Makkiyyah"}),e.jsx("option",{value:"medinan",children:"Madaniyyah"})]})]})]})})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:I?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(K,{size:"md"})}):B?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 mb-4",children:B}),e.jsx("button",{onClick:()=>v(o),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Coba Lagi"})]}):o&&m.length===0&&g===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(G,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil ditemukan"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Coba sesuaikan kata kunci atau filter pencarian Anda"}),e.jsx("button",{onClick:T,className:"text-green-600 hover:text-green-700 font-medium",children:"Hapus pencarian"})]}):o&&m.length===0&&g>0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(G,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Halaman ini kosong"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Halaman ini tidak memiliki hasil, tetapi ada ",g," hasil di halaman lain."]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{b(1),c.trim()&&v(c.trim(),1)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Kembali ke Halaman 1"}),e.jsx("button",{onClick:T,className:"text-green-600 hover:text-green-700 font-medium",children:"Hapus pencarian"})]})]}):m.length>0?e.jsxs("div",{className:"space-y-6 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Hasil Pencarian"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Menampilkan ",(h-1)*j+1,"-",Math.min(h*j,g)," dari ",g," hasil"]})]}),e.jsx("div",{className:"space-y-4 mb-8",children:ee.map((a,s)=>e.jsx(F,{to:`/surah/${a.surah_number}/${a.ayah_number||a.number}`,className:"block bg-white rounded-lg p-4 md:p-6 shadow-sm border border-gray-200 hover:border-green-300 hover:shadow-md transition-all overflow-hidden",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsxs("span",{className:"font-bold text-blue-700 text-sm",children:[a.surah_number,":",a.ayah_number||a.number]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 text-sm",children:[M(a.surah_info?.name_latin,c)," • Ayat ",a.ayah_number||a.number]}),e.jsx("p",{className:"text-gray-500 text-xs",children:M(a.surah_info?.name_indonesian,c)}),c&&e.jsx("p",{className:"text-blue-600 text-xs mt-1 font-medium",children:Ne(a,c)})]})]}),e.jsx(V,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"text-gray-700 text-sm leading-relaxed",children:e.jsxs("div",{className:"overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",wordBreak:"break-word"},children:[e.jsx("span",{className:"font-medium text-green-600",children:"Terjemahan:"}),' "',M(a.text_indonesian,c),'"']})})]})},`ayah-${a.surah_number}-${a.ayah_number||a.number}`))}),p>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-12 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:ae,disabled:h===1,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:re,disabled:h===1,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,p)},(a,s)=>{let r;return p<=5||h<=3?r=s+1:h>=p-2?r=p-4+s:r=h-2+s,e.jsx("button",{onClick:()=>_(r),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${h===r?"bg-green-600 text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:r},r)})}),e.jsx("button",{onClick:se,disabled:h===p,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:te,disabled:h===p,className:"p-2 rounded-lg border border-gray-300 text-gray-500 hover:text-gray-700 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pencarian Populer"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.map(a=>e.jsx("button",{onClick:()=>D(a),className:"px-4 py-2 bg-white border border-gray-300 rounded-full text-sm text-gray-700 hover:border-green-500 hover:text-green-600 transition-colors",children:a},a))})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Surah Pilihan"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:oe.map(a=>e.jsx(F,{to:`/surah/${a.number}`,className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:border-green-300 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"font-bold text-green-700 text-sm",children:a.number})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.name_latin||a.name_indonesian}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[a.total_ayahs," ayat"]})]}),e.jsx("p",{className:"font-arabic text-lg text-gray-700",children:a.name_arabic})]})},a.number))})]}),e.jsx("section",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Jelajahi Semua Surah"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Jelajahi Al-Quran lengkap dengan semua 114 surah"}),e.jsxs(F,{to:"/",className:"inline-flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(he,{className:"w-5 h-5"}),e.jsx("span",{children:"Lihat Semua Surah"})]})]})})]})})]})}const Le=le.memo(ke);export{Le as default};
